<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-TechnicalDocs/APP-intro/APP-intro" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Build an LLM Application | BUDDIE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://buddie-official.github.io/open-source-web/img/buddie-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://buddie-official.github.io/open-source-web/img/buddie-social-card.jpg"><meta data-rh="true" property="og:url" content="https://buddie-official.github.io/open-source-web/docs/TechnicalDocs/APP-intro/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Build an LLM Application | BUDDIE"><meta data-rh="true" name="description" content="This section will introduce how to quickly build an LLM application for text interaction using the existing code framework."><meta data-rh="true" property="og:description" content="This section will introduce how to quickly build an LLM application for text interaction using the existing code framework."><link data-rh="true" rel="icon" href="/open-source-web/img/fig_logo.png"><link data-rh="true" rel="canonical" href="https://buddie-official.github.io/open-source-web/docs/TechnicalDocs/APP-intro/"><link data-rh="true" rel="alternate" href="https://buddie-official.github.io/open-source-web/docs/TechnicalDocs/APP-intro/" hreflang="en"><link data-rh="true" rel="alternate" href="https://buddie-official.github.io/open-source-web/zh/docs/TechnicalDocs/APP-intro/" hreflang="zh"><link data-rh="true" rel="alternate" href="https://buddie-official.github.io/open-source-web/docs/TechnicalDocs/APP-intro/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Build an LLM Application","item":"https://buddie-official.github.io/open-source-web/docs/TechnicalDocs/APP-intro/"}]}</script><link rel="alternate" type="application/rss+xml" href="/open-source-web/blog/rss.xml" title="BUDDIE RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/open-source-web/blog/atom.xml" title="BUDDIE Atom Feed"><link rel="stylesheet" href="/open-source-web/assets/css/styles.6d82a20f.css">
<script src="/open-source-web/assets/js/runtime~main.63c42a18.js" defer="defer"></script>
<script src="/open-source-web/assets/js/main.18553b01.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/open-source-web/img/fig_logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/open-source-web/"><div class="navbar__logo"><img src="/open-source-web/img/fig_logo.png" alt="Buddie Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/open-source-web/img/fig_logo.png" alt="Buddie Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Buddie</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/open-source-web/docs/TechnicalDocs/quickstart/app_quickstart">Docs</a><a class="navbar__item navbar__link" href="/open-source-web/docs/Changelog_Blog/">Blog</a><a href="https://club.bud.inc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Buddie-AI/Buddie" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/open-source-web/docs/TechnicalDocs/APP-intro/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/open-source-web/zh/docs/TechnicalDocs/APP-intro/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">中文</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/open-source-web/docs/TechnicalDocs/quickstart/app_quickstart">Quick Start</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/open-source-web/docs/TechnicalDocs/quickstart/app_quickstart">APP Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/open-source-web/docs/TechnicalDocs/quickstart/preparation">Firmware</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/open-source-web/docs/TechnicalDocs/APP-intro/">APP Intro</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/open-source-web/docs/TechnicalDocs/APP-intro/">Build an LLM Application</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/open-source-web/docs/TechnicalDocs/SDK-intro/JL-docs">Firmware SDK Intro</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/open-source-web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">APP Intro</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Build an LLM Application</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Build an LLM Application</h1></header>
<p>This section will introduce how to quickly build an LLM application for text interaction using the existing code framework.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-implement">How to Implement<a href="#how-to-implement" class="hash-link" aria-label="Direct link to How to Implement" title="Direct link to How to Implement">​</a></h2>
<p><code>base_llm.dart</code> is the base abstraction layer that doesn&#x27;t depend on specific implementations, only defines interface standards, and reserves multimodal support (such as audio input/output), while also including UI display-related helper functions.</p>
<ul>
<li>Defines <code>LLMType</code> enum, including <code>customLLM</code> and <code>qwenOmni</code> two types.</li>
<li>Implements <code>LLMTypeExtension</code> for providing model icons, colors, and display names and other UI-related functionality.</li>
<li>Defines <code>LLMConfig</code> configuration class, supporting custom model parameters.</li>
<li>Defines <code>BaseLLM</code> abstract base class, specifying interfaces that all LLM implementations must support.</li>
</ul>
<p><strong>Main interfaces include:</strong></p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">initialize() // Initialize LLM (load configuration, establish connection)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dispose() // Release resources</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createRequest() // Synchronous text request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequest() // Streaming text request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequestWithAudio() // Streaming request with audio (throws unsupported exception by default)</span><br></span></code></pre></div></div>
<p>llm_factory.dart is the factory and management layer, using singleton pattern to manage LLM instance lifecycle, intelligently selecting the most suitable LLM type based on configuration and availability, supporting LLM type switching and configuration reloading, providing LLM status query and feature detection services.
Key interfaces include:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">getCurrentLLM() // Get current LLM instance (created on demand)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">getLLM() // Get specified type LLM instance</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">switchToLLMType() // Switch to specified LLM type</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">reloadLLMConfig() // Reload configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">isLLMAvailable() // Check if specified LLM type is available</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">getAvailableLLMTypes() // Get all available LLM types</span><br></span></code></pre></div></div>
<p>custom_llm.dart is the concrete implementation class for user-defined large language models, implementing functions such as loading user configuration, creating streaming and non-streaming requests, and processing return formats.
Key interfaces include:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">initialize() // Initialize and load user configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createRequest() // Non-streaming request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequest() // Streaming request</span><br></span></code></pre></div></div>
<p>qwen_omni_llm.dart is the concrete implementation class for multimodal language models, implementing Alibaba Cloud Tongyi Qianwen Omni multimodal API calls, processing audio input/output (WAV format), supporting streaming text responses and streaming responses with audio, and automatically handling Base64 audio encoding/decoding.
Key interfaces include:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequestWithAudio() // Audio request processing</span><br></span></code></pre></div></div>
<p>unified_chat_manager.dart is the upper-level service, providing unified chat interface, masking underlying LLM differences, automatically building input content with context, automatically managing chat session history and state, supporting persistence, loading and filtering of historical records.
Key interfaces include:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">init() // Initialize chat manager</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequest() // Create text streaming request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createStreamingRequestWithAudio() // Create streaming request with audio</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buildInput() // Build input with historical records</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">addChatSession() // Add chat session</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-build-custom-llm-with-unifiedchatmanager">How to Build Custom LLM with UnifiedChatManager<a href="#how-to-build-custom-llm-with-unifiedchatmanager" class="hash-link" aria-label="Direct link to How to Build Custom LLM with UnifiedChatManager" title="Direct link to How to Build Custom LLM with UnifiedChatManager">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-set-up-custom-llm">How to Set Up Custom LLM<a href="#how-to-set-up-custom-llm" class="hash-link" aria-label="Direct link to How to Set Up Custom LLM" title="Direct link to How to Set Up Custom LLM">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-env-file">Create env file<a href="#create-env-file" class="hash-link" aria-label="Direct link to Create env file" title="Direct link to Create env file">​</a></h4>
<p>Create an env file in the project root directory (at the same level as pubspec.yaml):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Execute in project root directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch env</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configure-environment-variables">Configure environment variables<a href="#configure-environment-variables" class="hash-link" aria-label="Direct link to Configure environment variables" title="Direct link to Configure environment variables">​</a></h4>
<p>Add the following configuration to the env file, replacing the example values with your actual API keys:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Custom LLM configuration (OpenAI compatible)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_LLM_TOKEN=your_openai_api_key_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_LLM_URL=https://api.openai.com/v1/chat/completions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_LLM_MODEL=gpt-4o</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Alibaba Cloud DashScope API Key (for QwenOmni multimodal)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_ALIBABA_API_KEY=your_alibaba_dashscope_api_key_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Tencent Cloud ASR configuration (for cloud speech recognition)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_TENCENT_SECRET_ID=your_tencent_secret_id_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_TENCENT_SECRET_KEY=your_tencent_secret_key_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_TENCENT_TOKEN=your_tencent_token_here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># OpenAI TTS configuration (for speech synthesis)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DEFAULT_OPENAI_TTS_BASE_URL=https://api.openai.com/v1/audio/speech</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-call-and-obtain-results">How to Call and Obtain Results<a href="#how-to-call-and-obtain-results" class="hash-link" aria-label="Direct link to How to Call and Obtain Results" title="Direct link to How to Call and Obtain Results">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Follow the example below to make calls and create text requests:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Initialize manager</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final manager = UnifiedChatManager();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await manager.init(systemPrompt: &quot;You are a professional assistant&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Streaming text conversation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final stream = manager.createStreamingRequest(text: &quot;Hello&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stream.listen((response) =&gt; print(response));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Non-streaming text conversation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final response = manager.createRequest(text: &quot;Hello&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print(response)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-maintain-conversation-context">How to Maintain Conversation Context<a href="#how-to-maintain-conversation-context" class="hash-link" aria-label="Direct link to How to Maintain Conversation Context" title="Direct link to How to Maintain Conversation Context">​</a></h3>
<p>By default, when using createStreamingRequest to call streaming text requests, the buildInput function will be automatically called to combine all historical information into one message. buildInput reads ChatSession, so you need to manually call addChatSession to add historical sessions, as follows:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Initialize manager</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final manager = UnifiedChatManager();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await manager.init(systemPrompt: &quot;You are a professional assistant&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Add historical records</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">manager.addChatSession(&#x27;user&#x27;, &quot;Hello&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">manager.addChatSession(&#x27;assistant&#x27;, &quot;How can I help you?&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Streaming text conversation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final stream = manager.createStreamingRequest(text: &quot;How&#x27;s the weather today?&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stream.listen((response) =&gt; print(response));</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-qwen-omni">How to Use Qwen Omni<a href="#how-to-use-qwen-omni" class="hash-link" aria-label="Direct link to How to Use Qwen Omni" title="Direct link to How to Use Qwen Omni">​</a></h3>
<p>Follow the example below to make calls and create requests that include both audio and text:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Initialize manager</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final manager = UnifiedChatManager();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await manager.init(systemPrompt: &quot;You are a professional assistant&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Audio conversation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final audioStream = manager.createStreamingRequestWithAudio(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    audioData: audioBytes,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    userMessage: text,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">audioStream.listen((response) =&gt; print(response));</span><br></span></code></pre></div></div>
<p>Note: createStreamingRequestWithAudio will also automatically read ChatSession by default to build text context.</p>
<h1>ASR</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-we-implement-it">How We Implement It<a href="#how-we-implement-it" class="hash-link" aria-label="Direct link to How We Implement It" title="Direct link to How We Implement It">​</a></h2>
<p>For classic Bluetooth, we use AudioRecorder to implement microphone recording, dependencies:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependencies:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    record: ^5.1.2</span><br></span></code></pre></div></div>
<p>For low-power Bluetooth, we designed a BleService class specifically for low-power Bluetooth voice data transmission. It provides low-power Bluetooth device connection, data transmission and state management, dependencies:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependencies:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    flutter_foreground_task: 8.13.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    flutter_blue_plus: ^1.34.5</span><br></span></code></pre></div></div>
<p>Key interfaces include:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">init() // Initialize service, get saved deviceRemoteId, auto-reconnect if exists</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">getAndConnect() // Actively get deviceRemoteId and connect</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listenToConnectionState() // Listen to Bluetooth connection state changes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">forgetDevice() // Forget device: disconnect and clear saved device information</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dispose() // Release resources, cancel subscriptions and close data stream</span><br></span></code></pre></div></div>
<p>Key members:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">final StreamController&lt;Uint8List&gt; _dataController = StreamController&lt;Uint8List&gt;();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stream&lt;Uint8List&gt; get dataStream =&gt; _dataController.stream;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">External parties obtain transmission data from low-power Bluetooth devices by listening to dataStream.</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-record-audio">How to Record Audio<a href="#how-to-record-audio" class="hash-link" aria-label="Direct link to How to Record Audio" title="Direct link to How to Record Audio">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-classic-bluetooth-for-voice-data-transmission-or-direct-phone-microphone-recording">Using Classic Bluetooth for Voice Data Transmission or Direct Phone Microphone Recording<a href="#using-classic-bluetooth-for-voice-data-transmission-or-direct-phone-microphone-recording" class="hash-link" aria-label="Direct link to Using Classic Bluetooth for Voice Data Transmission or Direct Phone Microphone Recording" title="Direct link to Using Classic Bluetooth for Voice Data Transmission or Direct Phone Microphone Recording">​</a></h3>
<p>After obtaining microphone permissions, follow the example below to turn on the microphone:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Configure microphone parameters, example only</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const config = RecordConfig(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    encoder: AudioEncoder.pcm16bits,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sampleRate: 16000,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    numChannels: 1,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Turn on microphone</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final recorder = AudioRecorder();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final recordStream = await recorder.startStream(config);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recordStream.listen((data) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-low-power-bluetooth-for-voice-data-transmission">Using Low-Power Bluetooth for Voice Data Transmission<a href="#using-low-power-bluetooth-for-voice-data-transmission" class="hash-link" aria-label="Direct link to Using Low-Power Bluetooth for Voice Data Transmission" title="Direct link to Using Low-Power Bluetooth for Voice Data Transmission">​</a></h3>
<p>After connecting with low-power Bluetooth devices, follow the example below to listen for data:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">await BleService().init();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final bleDataSubscription = BleService().dataStream.listen((value) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span></code></pre></div></div>
<h1>TTS</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-implement-1">How to Implement<a href="#how-to-implement-1" class="hash-link" aria-label="Direct link to How to Implement" title="Direct link to How to Implement">​</a></h2>
<p>Using Flutter TTS to use the phone&#x27;s local text-to-speech module, dependencies:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependencies:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    flutter_tts: ^4.0.2</span><br></span></code></pre></div></div>
<p>For specific implementation details, refer to the <a href="https://pub.dev/packages/flutter_tts" target="_blank" rel="noopener noreferrer">flutter_tts official documentation</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use">How to Use<a href="#how-to-use" class="hash-link" aria-label="Direct link to How to Use" title="Direct link to How to Use">​</a></h2>
<p>Example code is as follows:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Initialize</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final flutterTts = FlutterTts();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await _flutterTts.awaitSpeakCompletion(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (Platform.isAndroid) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await _flutterTts.setQueueMode(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Call text-to-speech</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flutterTts.speak(&quot;Hello, this is a text-to-speech test.&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Interrupt or stop speech synthesis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flutterTts.stop();</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/TechnicalDocs/APP-intro/APP-intro.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/open-source-web/docs/TechnicalDocs/quickstart/flash"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Flashing Firmware Using the Forced Download Tool</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/open-source-web/docs/TechnicalDocs/SDK-intro/JL-docs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JL Official Documentation Description</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-implement" class="table-of-contents__link toc-highlight">How to Implement</a></li><li><a href="#how-to-build-custom-llm-with-unifiedchatmanager" class="table-of-contents__link toc-highlight">How to Build Custom LLM with UnifiedChatManager</a><ul><li><a href="#how-to-set-up-custom-llm" class="table-of-contents__link toc-highlight">How to Set Up Custom LLM</a></li><li><a href="#how-to-call-and-obtain-results" class="table-of-contents__link toc-highlight">How to Call and Obtain Results</a></li><li><a href="#how-to-maintain-conversation-context" class="table-of-contents__link toc-highlight">How to Maintain Conversation Context</a></li><li><a href="#how-to-use-qwen-omni" class="table-of-contents__link toc-highlight">How to Use Qwen Omni</a></li></ul></li><li><a href="#how-we-implement-it" class="table-of-contents__link toc-highlight">How We Implement It</a></li><li><a href="#how-to-record-audio" class="table-of-contents__link toc-highlight">How to Record Audio</a><ul><li><a href="#using-classic-bluetooth-for-voice-data-transmission-or-direct-phone-microphone-recording" class="table-of-contents__link toc-highlight">Using Classic Bluetooth for Voice Data Transmission or Direct Phone Microphone Recording</a></li><li><a href="#using-low-power-bluetooth-for-voice-data-transmission" class="table-of-contents__link toc-highlight">Using Low-Power Bluetooth for Voice Data Transmission</a></li></ul></li><li><a href="#how-to-implement-1" class="table-of-contents__link toc-highlight">How to Implement</a></li><li><a href="#how-to-use" class="table-of-contents__link toc-highlight">How to Use</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/open-source-web/docs/TechnicalDocs/quickstart/app_quickstart">Quick Start</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/hSDEbnqB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>